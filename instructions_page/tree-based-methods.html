
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- <link rel="icon" href="../../favicon.ico"> -->

    <!-- import JS libraries -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    <script src="js/highlight.js/highlight.pack.js"></script>
    <script src="js/bootstrap.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <title></title>

    <!-- core CSS -->
    <link href="css/skeleton.css" rel="stylesheet">
    <link href="css/custom.css" rel="stylesheet">
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="js/highlight.js/styles/codepen-embed.css" rel="stylesheet">
  </head>

  <body>
    <div class="container-fluid">
      <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
      <!-- Banner -->
      <div class="row">
        <div class="eight columns offset-by-two banner">
          <h1 class="banner-head">Tree-based Methods</h1>
        </div>
      </div>
      <!-- Banner -->

      <!-- Exercise 1 -->
      <div class="row">
        <div class="eight columns offset-by-two exercise">
        <h3 class="head">Exercise 1</h3>
        <ol>
          <li>Use the <span class='function'>lm()</span> function to perform a simple linear regression with mpg as the response and horsepower as the predictor. Use the <b class='function'>summary()</b> function to print the results. Comment on the output.</li>
            <ul>
            <li>
<<<<<<< HEAD
              Is there a relationship between the predictor and the re-sponse? <a href="#x2q1" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q1"> Need a hint?</a>
              <div class="collapse" id="x2q1">
=======
              Is there a relationship between the predictor and the re-sponse? <a href="#x1q1" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x1q1"> Need a hint?</a>
              <div class="collapse" id="x1q1">
                <h5>Hint 1:</h5>
>>>>>>> c020a038604a34f2c29b7b14e6a21d2460be2441
                <pre><code>
# Remember to split your data in training and test sets, for this you can use the following function:
train_indices = sample(...)
# Sample requires a vector or an integer, an integer is easily obtained by applying the nrow() function to your dataframe.
                </code></pre>
                <h5>Hint 2:</h5>
                <pre><code>
library(tree)
var_name = tree('response_variable' ~ ., data = 'dataset', subset = 'train_indices')
                </code></pre>
                <h5>Hint 3:</h5>
                <pre><code>
# Tree has a built-in cross-validation function, lucky for us!
# As default cross validation has a K of 10. You can play with this
cross_validated_tree = cv.tree('your tree variables')
                </code></pre>
              </div>
            </li>
            <li>How strong is the relationship between the predictor and the response?</li>
            <li>Is the relationship between the predictor and the response positive or negative?</li>
            <li>What is the predicted mpg associated with a horsepower of 98? What are the associated 95 % confidence and prediction intervals?</li>
            </ul>
          <li>Plot the response and the predictor. Use the <b class='function'>abline()</b> function to display the least squares regression line.</li>
          <li>Use the <b class='function'>plot()</b> function to produce diagnostic plots of the least squares regression fit. Comment on any problems you see with the fit.</li>
        </ol>
        </div>
      </div>
      <!-- !Exercise 1 -->

      <!-- Exercise 2 -->
      <div class="row">
        <div class="eight columns offset-by-two exercise">
        <h3 class="head">Exercise 2</h3>
        <span><b>Dataset</b>: Carseats</span><br>
        <span><b>Packages</b>: tree, ISLR, randomForest</span><br>
        <span><b>Question</b>: Predict Sales using regression trees and related approaches, treating the response as a quantitative variable. We use the <b>mean squared error (MSE)</b> as evaluation metric. You will need to end up with a total of <b>four</b> models. Store the MSE of the <b>normal</b> decision trees in their own variable.</span><br><br>
        <ol>
          <li>Explore the data by making some informative plots and summaries. Use the ?Carseats command to ask R for a description of the dataset. <a href="#x1q0" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x1q0" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x1q0">
            <pre><code>
# Use for example the plot() function and pairs() function to do some plotting.
# Use the ? command within R for more information on how to plot data.
            </code></pre>
          </div>
          <li>Split the data set into a training set and a test set. <a href="#x1q1" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x1q1" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x1q1">
            <pre><code>
# Remember to split your data in training and test sets, for this you can use the following function:
train_indices = sample(...)
# Sample requires a vector or an integer, an integer is easily obtained by applying the nrow() function to your dataframe.
            </code></pre>
          </div>
          <li>Fit a normal regression tree to the training set. Plot the tree, and interpret the results. What test MSE do you obtain? <a href="#x1q2" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x1q2" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x1q2">
            <pre><code>
# To build a tree in R we use the tree library
library(tree)
var_name = tree('response_variable' ~ ., data = 'dataset', subset = 'train_indices')

# To obtain the MSE (Mean Squared Error) you can subtract your predictions from each true value in your test set. Square each result and take the mean.
mean((y-yhat)^2)
            </code></pre>
          </div>
          <li>Cross-validation in order to determine the optimal level of tree complexity. Does pruning the tree improve the test MSE? <a href="#x1q3" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x1q3" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x1q3">
            <pre><code>
# Tree has a built-in cross-validation function, lucky for us!
# As default cross validation has a K of 10. You can play with this
cross_validated_tree = cv.tree('your tree variables')

# You can plot the cross validated tree using the plot function.
plot(cross_validated_tree)
            </code></pre>
          </div>
          <li>Use the bagging approach in order to analyze this data. What test MSE do you obtain? Use the importance() function to determine which variables are most important. <a href="#x1q4" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x1q4" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x1q4">
            <pre><code>
# For bagging we can use the randomForest package, with an adjusted variable of 'mtry' which indicates the number of features used.
# Remember, bagging samples from all data with replacement and uses all features.
car.forest = randomForest('your formula', data='...', subset='...', mtry='...', ntree='...')
          </code></pre>
          </div>
          <li>Use random forests to analyze this data. What test MSE do you obtain? Use the importance() function to determine which variables are most important. <a href="#x1q5" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x1q5" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x1q5">
            <pre><code>
# This one should be easy, remember the difference between bagging and random forest. Use the random forest library.
            </code></pre>
          </div>
          <li>Try to make a single plot with the MSE on the y-axis and the number of trees on the x-axis for each approach.<a href="#x1q6" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x1q6" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x1q6">
            <pre><code>
# This question might be a bit harder. Remember, the normal tree approach has a single MSE, the randomForest approaches log an MSE per number of trees used.
# Explore the randomForest package to find out where the MSE is stored, then try to make the plot.

# You will have four models:
# - Full grown tree
# - Pruned tree
# - The bagging model
# _ The random forest model

abline() # plots a straight line.
lines() # plots lines based on x, y coordinates.
            </code></pre>
          </div>
        </ol>
        </div>
      </div>
      <!-- !Exercise 2 -->

      <!-- Exercise 3 -->
      <div class="row">
        <div class="eight columns offset-by-two exercise">
        <h3 class="head">Exercise 3</h3>
        <span><b>Dataset</b>: OJ, part of the ISLR library</span><br>
        <span><b>Packages</b>: ISLR, tree</span><br>
        <span><b>Question</b>: This question is concerned with the OJ dataset which is part of the ISLR library.</span><br><br>
        <ol>
          <li>Create a training set containing a random sample of 800 observations, and a test set containing the remaining observations. <a href="#x2q0" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q0" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x2q0">
            <pre><code>
            </code></pre>
          </div>
          <li>Fit a tree to the training data, with Purchase as the response and the other variables as predictors. Use the summary() function to produce summary statistics about the tree, and describe the results obtained. What is the training error rate? How many terminal nodes does the tree have?
<a href="#x2q1" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q1" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x2q1">
            <pre><code>
            </code></pre>
          </div>
          <li>Type in the name of the tree object in order to get a detailed text output. Pick one of the terminal nodes, and interpret the information displayed.
<a href="#x2q2" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q2" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x2q2">
            <pre><code>
            </code></pre>
          </div>
          <li>Create a plot of the tree, and interpret the results.
<a href="#x2q3" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q3" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x2q3">
            <pre><code>
            </code></pre>
          </div>
          <li>Predict the response on the test data, and produce a confusion matrix comparing the test labels to the predicted test labels. What is the test error rate?
<a href="#x2q4" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q4" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x2q4">
            <pre><code>
          </code></pre>
          </div>
          <li>Apply the cv.tree() function to the training set in order to determine the optimal tree size.
<a href="#x2q5" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q5" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x2q5">
            <pre><code>
            </code></pre>
          </div>
          <li>Produce a plot with tree size on the x-axis and cross-validated classification error rate on the y-axis.
<a href="#x2q6" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q6" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x2q6">
            <pre><code>

            </code></pre>
          </div>
          <li>Which tree size corresponds to the lowest cross-validated classification error rate?

<a href="#x2q6" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q6" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x2q6">
            <pre><code>

            </code></pre>
          </div>
          <li>Produce a pruned tree corresponding to the optimal tree size obtained using cross-validation. If cross-validation does not lead to selection of a pruned tree, then create a pruned tree with five terminal nodes.
<a href="#x2q6" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q6" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x2q6">
            <pre><code>

            </code></pre>
          </div>
          <li>Produce a pruned tree corresponding to the optimal tree size obtained using cross-validation. If cross-validation does not lead to selection of a pruned tree, then create a pruned tree with five terminal nodes.
<a href="#x2q6" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q6" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x2q6">
            <pre><code>

            </code></pre>
          </div>
          <li>Compare the test error rates between the pruned and unpruned trees. Which is higher?
<a href="#x2q6" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q6" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x2q6">
            <pre><code>

            </code></pre>
          </div>
        </ol>
        </div>
      </div>
      <!-- !Exercise 3 -->




      <!-- Exercise 2 -->
      <div class="row">
        <div class="eight columns offset-by-two exercise">
        <h3 class="head">Exercise 2</h3>
        <span><b>Dataset</b>: </span><br>
        <span><b>Packages</b>: </span><br>
        <span><b>Question</b>: </span><br><br>
        <ol>
          <li><a href="#x2q0" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q0" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x2q0">
            <pre><code>
            </code></pre>
          </div>
          <li><a href="#x2q1" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q1" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x2q1">
            <pre><code>
            </code></pre>
          </div>
          <li><a href="#x2q2" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q2" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x2q2">
            <pre><code>
            </code></pre>
          </div>
          <li><a href="#x2q3" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q3" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x2q3">
            <pre><code>
            </code></pre>
          </div>
          <li><a href="#x2q4" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q4" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x2q4">
            <pre><code>
          </code></pre>
          </div>
          <li><a href="#x2q5" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q5" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x2q5">
            <pre><code>
            </code></pre>
          </div>
          <li><a href="#x2q6" role="button" data-toggle="collapse" aria-expanded="false" aria-controls="x2q6" class='question'>Need a hint?</a></li>
          <div class="collapse" id="x2q6">
            <pre><code>

            </code></pre>
          </div>
        </ol>
        </div>
      </div>
      <!-- !Exercise 3 -->

    </div>
  </body>
</html>
